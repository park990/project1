<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="std">

    <select id="get_no" resultType="pm.vo.stdVO" parameterType="String">
        select * from std_t
        where stdno = #{value}
    </select>

    <!-- stdno를 통해 2개의 테이블 연결하여 강의명, 강사명, 시작date, 강의index 따와야 됨.-->
    <select id="get_total" resultType="pm.vo.totalDTO" parameterType="String">
        SELECT ls.lec_name, la.ad_name, la.ad_sdate, la.lec_no
        FROM std_t s
        INNER JOIN lec_std_t ls ON s.stdno = ls.stdno
        INNER JOIN lec_adm_t la ON ls.lec_no = la.lec_no
        WHERE s.stdno = #{stdno}
    </select>

    <!-- stdno를 통해서 시험 정보들 불러와야됨. -->
    <select id="get_test" resultType="pm.vo.testDTO" parameterType="String">
        SELECT ls.lec_name, t.test_name, ls.lec_no, la.ad_name, t.test_idx, s.stdno
        FROM std_t s
        INNER JOIN lec_std_t ls ON s.stdno = ls.stdno
        INNER JOIN lec_adm_t la ON ls.lec_no = la.lec_no
        INNER JOIN test_t t ON ls.lec_no = t.lec_no
        WHERE s.stdno = #{stdno}
    </select>

    <!-- 학생 정보 수정 시 std_t update -->
    <update id="update_std_t" parameterType="pm.vo.stdVO">
        UPDATE std_t
        <set>
            <if test="std_email != null">std_email = #{std_email},</if>
            <if test="std_phone != null">std_phone = #{std_phone},</if>
            <if test="std_address != null">std_address = #{std_address},</if>
        </set>
        WHERE stdno = #{stdno}
    </update>
    
    <!-- 시험 응시 여부 -->
    <select id="get_test_auth" resultType="pm.vo.stdVO" parameterType="String">
        SELECT stdno
        FROM std_anw_t
        WHERE test_idx = #{test_idx}
    </select>
    <!-- 사진 변경 시 update -->
    <select id="update_img" resultType="pm.vo.stdVO" parameterType="String">
        UPDATE std_t
        SET std_image = #{std_image}
        WHERE stdno = #{stdno}
    </select>


</mapper>