<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="lec_t"> <!--테이블 명 or 파일명-->

    <select id="all" resultType="pm.vo.ClassVO" parameterType="Map">
        SELECT * FROM lec_t l INNER JOIN admin_t a ON l.adno = a.adno;
    </select>


    <select id="studentAll" resultType="pm.vo.StudentVO" parameterType="Map">
        SELECT * FROM std_t;
    </select>

    <!--강의 이름으로 검색-->
    <select id="lec_search" resultType="pm.vo.ClassVO" parameterType="String">
        SELECT l.lec_name, a.ad_name, l.lec_sdate, l.lec_edate, l.lec_limit
        FROM lec_t l INNER JOIN admin_t a
        ON l.adno = a.adno
        WHERE lec_name LIKE CONCAT('%', #{lec_name}, '%')
    </select>

    <!--강의 번호 조회-->
    <select id="selectAdminNo" resultType="String" parameterType="String">
        SELECT adno
        FROM admin_t
        WHERE ad_name = #{ad_name}
    </select>

    <!--강의 상세정보 수정-->
    <update id="modify" parameterType="pm.vo.ClassVO">
        UPDATE lec_t
        SET lec_name = #{lec_name},
        adno = #{adno},
        lec_sdate = #{lec_sdate},
        lec_edate = #{lec_edate},
        lec_limit = #{lec_limit},
        lec_info = #{lec_info}
        WHERE lec_no = #{lec_no}
    </update>

    <!--강의 추가-->
    <insert id="insert" parameterType="pm.vo.ClassVO" useGeneratedKeys="true" keyProperty="lec_no">
        INSERT INTO lec_t (
        lec_no, lec_name, adno, lec_sdate, lec_edate, lec_limit, lec_info
        ) VALUES (
        #{lec_no}, #{lec_name}, #{adno}, #{lec_sdate}, #{lec_edate}, #{lec_limit}, #{lec_info}
        )
    </insert>
    <select id="mylec" parameterType="String"  resultType="pm.vo.ClassVO">
        SELECT * FROM lec_t l INNER JOIN admin_t a ON l.adno = a.adno
        WHERE a.adno = #{adno}
    </select>

</mapper>